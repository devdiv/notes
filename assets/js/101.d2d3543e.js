(window.webpackJsonp=window.webpackJsonp||[]).push([[101],{267:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},(function(){var t=this.$createElement;this._self._c;return this._m(0)}),[function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[a("h2",{attrs:{id:"ruby-文件操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ruby-文件操作"}},[t._v("#")]),t._v(" Ruby 文件操作")]),t._v(" "),a("p",[t._v("1、File.new")]),t._v(" "),a("p",[t._v("创建一个 File 对象用于读取、写入或者读写，读写权限取决于 mode 参数。可以使用 File.close 方法来关闭该文件。")]),t._v(" "),a("div",{staticClass:"language-ruby extra-class"},[a("pre",{pre:!0,attrs:{class:"language-ruby"}},[a("code",[t._v("aFile "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("File")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"filename"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mode"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ... 处理文件")]),t._v("\naFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("close\n")])])]),a("p",[t._v("2、File.open")]),t._v(" "),a("div",{staticClass:"language-ruby extra-class"},[a("pre",{pre:!0,attrs:{class:"language-ruby"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("File")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("open"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"filename"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mode"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("aFile"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ... process the file")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n")])])]),a("p",[a("code",[t._v("File.open")]),t._v(" 和 "),a("code",[t._v("File.new")]),t._v(" 方法之间异同点：")]),t._v(" "),a("ul",[a("li",[t._v("相同点：都是创建一个新的 "),a("code",[t._v("file")]),t._v(" 对象，并把该 "),a("code",[t._v("file")]),t._v(" 对象赋值给文件。")]),t._v(" "),a("li",[t._v("不同点：是 "),a("code",[t._v("File.open")]),t._v(" 方法可与块关联，而 "),a("code",[t._v("File.new")]),t._v(" 方法不能。")])]),t._v(" "),a("p",[t._v("下表列出了"),a("code",[t._v("File.open")]),t._v(" 和 "),a("code",[t._v("File.new")]),t._v(" 方法中可使用的模式：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("模式")]),t._v(" "),a("th",[t._v("描述")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("r")]),t._v(" "),a("td",[t._v("只读模式。文件指针被放置在文件的开头。这是默认模式。")])]),t._v(" "),a("tr",[a("td",[t._v("r+")]),t._v(" "),a("td",[t._v("读写模式。文件指针被放置在文件的开头。")])]),t._v(" "),a("tr",[a("td",[t._v("w")]),t._v(" "),a("td",[t._v("只写模式。如果文件存在，则重写文件。如果文件不存在，则创建一个新文件用于写入。")])]),t._v(" "),a("tr",[a("td",[t._v("w+")]),t._v(" "),a("td",[t._v("读写模式。如果文件存在，则重写已存在的文件。如果文件不存在，则创建一个新文件用于读写。")])]),t._v(" "),a("tr",[a("td",[t._v("a")]),t._v(" "),a("td",[t._v("只写模式。如果文件存在，则文件指针被放置在文件的末尾。也就是说，文件是追加模式。如果文件不存在，则创建一个新文件用于写入。")])]),t._v(" "),a("tr",[a("td",[t._v("a+")]),t._v(" "),a("td",[t._v("读写模式。如果文件存在，则文件指针被放置在文件的末尾。也就是说，文件是追加模式。如果文件不存在，则创建一个新文件用于读写。")])])])]),t._v(" "),a("p",[t._v("3、File.chmod")]),t._v(" "),a("p",[t._v("下表列出了 chmod 方法中可使用的不同的掩码：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("掩码")]),t._v(" "),a("th",[t._v("描述")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("0700")]),t._v(" "),a("td",[t._v("rwx 掩码，针对所有者")])]),t._v(" "),a("tr",[a("td",[t._v("0400")]),t._v(" "),a("td",[t._v("r ，针对所有者")])]),t._v(" "),a("tr",[a("td",[t._v("0200")]),t._v(" "),a("td",[t._v("w ，针对所有者")])]),t._v(" "),a("tr",[a("td",[t._v("0100")]),t._v(" "),a("td",[t._v("x ，针对所有者")])]),t._v(" "),a("tr",[a("td",[t._v("0070")]),t._v(" "),a("td",[t._v("rwx 掩码，针对所属组")])]),t._v(" "),a("tr",[a("td",[t._v("0040")]),t._v(" "),a("td",[t._v("r ，针对所属组")])]),t._v(" "),a("tr",[a("td",[t._v("0020")]),t._v(" "),a("td",[t._v("w ，针对所属组")])]),t._v(" "),a("tr",[a("td",[t._v("0010")]),t._v(" "),a("td",[t._v("x ，针对所属组")])]),t._v(" "),a("tr",[a("td",[t._v("0007")]),t._v(" "),a("td",[t._v("rwx 掩码，针对其他人")])]),t._v(" "),a("tr",[a("td",[t._v("0004")]),t._v(" "),a("td",[t._v("r ，针对其他人")])]),t._v(" "),a("tr",[a("td",[t._v("0002")]),t._v(" "),a("td",[t._v("w ，针对其他人")])]),t._v(" "),a("tr",[a("td",[t._v("0001")]),t._v(" "),a("td",[t._v("x ，针对其他人")])]),t._v(" "),a("tr",[a("td",[t._v("4000")]),t._v(" "),a("td",[t._v("执行时设置用户 ID")])]),t._v(" "),a("tr",[a("td",[t._v("2000")]),t._v(" "),a("td",[t._v("执行时设置所属组 ID")])]),t._v(" "),a("tr",[a("td",[t._v("1000")]),t._v(" "),a("td",[t._v("保存交换文本，甚至在使用后也会保存")])])])]),t._v(" "),a("p",[t._v("4、文件常用操作方法总结：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("方法")]),t._v(" "),a("th",[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("sysread")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[t._v("syswrite")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[t._v("each_byte")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[t._v("IO.readlines")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[t._v("IO.foreach")]),t._v(" "),a("td")])])]),t._v(" "),a("p",[t._v("文件常用操作实例：")]),t._v(" "),a("div",{staticClass:"language-ruby extra-class"},[a("pre",{pre:!0,attrs:{class:"language-ruby"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#!/usr/bin/ruby")]),t._v("\n\n\naFile "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("File")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"input.txt"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"r"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" aFile\n   content "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" aFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sysread"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n   puts content\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n   puts "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Unable to open file!"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n\naFile "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("File")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"input.txt"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"r+"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" aFile\n   aFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("syswrite"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ABCDEF"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n   puts "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Unable to open file!"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n\naFile "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("File")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"input.txt"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"r+"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" aFile\n   aFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("syswrite"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ABCDEF"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n   aFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rewind\n   aFile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("each_byte "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("ch"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" putc ch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" putc "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n   puts "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Unable to open file!"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n\narr "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("IO")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("readlines"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"input.txt"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nputs arr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nputs arr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("IO")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("foreach"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"input.txt"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("block"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" puts block"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 重命名文件 test1.txt 为 test2.txt")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("File")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rename"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test1.txt"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test2.txt"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 删除文件 test2.txt")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("File")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("delete"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"text2.txt"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nfile "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("File")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test.txt"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"w"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nfile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("chmod"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0755")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])])}],!1,null,null,null);s.default=e.exports}}]);